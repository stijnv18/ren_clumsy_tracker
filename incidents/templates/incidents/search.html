{% extends 'incidents/base.html' %}
{% block title %}Search Clumsy Moments{% endblock %}
{% block content %}
    <h1>Search Clumsy Moments</h1>
    <form method="get" style="margin-bottom:1em;">
        <label for="friend_name">Friend Name:</label>
        <input type="text" name="friend_name" id="friend_name" value="{{ request.GET.friend_name }}">
        <label for="clumsy_level">Clumsy Level:</label>
        <select name="clumsy_level" id="clumsy_level">
            <option value="">Any</option>
            <option value="1" {% if request.GET.clumsy_level == '1' %}selected{% endif %}>Minor</option>
            <option value="2" {% if request.GET.clumsy_level == '2' %}selected{% endif %}>Noticeable</option>
            <option value="3" {% if request.GET.clumsy_level == '3' %}selected{% endif %}>Major</option>
            <option value="4" {% if request.GET.clumsy_level == '4' %}selected{% endif %}>Legendary</option>
        </select>
        <button type="submit" class="btn">Search</button>
    </form>
    <h2>Results</h2>
    {% for incident in incidents %}
        <div class="incident" style="background:#ffe6fa; border-radius:12px; box-shadow:0 2px 8px #e0e0e0; margin:1em 0; padding:1em;">
            <strong style="color:#a259e6;">{{ incident.friend_name }}</strong> on <em>{{ incident.date|date:'Y-m-d H:i' }}</em><br>
            <span>{{ incident.description }}</span><br>
            <small>Clumsy Level: <span style="color:#d291fa;">{{ incident.get_clumsy_level_display }}</span></small>
        </div>
    {% empty %}
        <p>No clumsy moments found!</p>
    {% endfor %}
    <a href="{% url 'home' %}"><button class="btn" style="background:#d291fa;">Back to Home</button></a>
{% endblock %}
