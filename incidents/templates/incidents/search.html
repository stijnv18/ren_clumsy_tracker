{% extends 'incidents/base.html' %}
{% block title %}Search Clumsy Moments{% endblock %}
{% block content %}
    <h1>Search Clumsy Moments</h1>
    <form method="get" class="mb-3">
        <div class="mb-3">
            <label for="friend_name" class="form-label">Friend Name:</label>
            <input type="text" name="friend_name" id="friend_name" value="{{ request.GET.friend_name }}" class="form-control">
        </div>
        <div class="mb-3">
            <label for="clumsy_level" class="form-label">Clumsy Level:</label>
            <select name="clumsy_level" id="clumsy_level" class="form-select">
                <option value="">Any</option>
                <option value="1" {% if request.GET.clumsy_level == '1' %}selected{% endif %}>Minor</option>
                <option value="2" {% if request.GET.clumsy_level == '2' %}selected{% endif %}>Noticeable</option>
                <option value="3" {% if request.GET.clumsy_level == '3' %}selected{% endif %}>Major</option>
                <option value="4" {% if request.GET.clumsy_level == '4' %}selected{% endif %}>Legendary</option>
            </select>
        </div>
        <button type="submit" class="cute-btn">Search</button>
    </form>
    <h2>Results</h2>
    {% for incident in incidents %}
        <div class="card mb-3 shadow-sm" style="background:#ffe6fa; border-radius:16px;">
            <div class="card-body">
                <h5 class="card-title" style="color:#a259e6;">{{ incident.friend_name }}</h5>
                <h6 class="card-subtitle mb-2 text-muted">{{ incident.date|date:'Y-m-d H:i' }}</h6>
                <p class="card-text">{{ incident.description }}</p>
                <span class="badge rounded-pill" style="background:#d291fa; color:#fff;">{{ incident.get_clumsy_level_display }}</span>
            </div>
        </div>
    {% empty %}
        <p>No clumsy moments found!</p>
    {% endfor %}
    <a href="{% url 'home' %}"><button class="cute-btn" style="background:#d291fa;">Back to Home</button></a>
{% endblock %}
